Part 1 is easy.

I tried to solve part 2 by myself for a long time, but I have no good solution and I am too long out of academia to write my own equation solver.
I also do not know a quickly installable solver for C++, so I fell back to Python and used the Z3 solver.
This makes the task pretty much trivial, as the conceptual solution is very well behaved.

